---
# This is the internal user database
# The hash value is a bcrypt hash and can be generated with plugin/tools/hash.sh

# Changes to this file requires the securityadmin.sh tool to be run to apply the changes.
# docker exec -it wazuh.indexer bash

# export INSTALLATION_DIR=/usr/share/wazuh-indexer
# export CONFIG_DIR=$INSTALLATION_DIR/config
# CACERT=$CONFIG_DIR/certs/root-ca.pem
# KEY=$CONFIG_DIR/certs/admin-key.pem
# CERT=$CONFIG_DIR/certs/admin.pem
# export JAVA_HOME=/usr/share/wazuh-indexer/jdk

# bash /usr/share/wazuh-indexer/plugins/opensearch-security/tools/securityadmin.sh -cd $CONFIG_DIR/opensearch-security/ -nhnv -cacert  $CACERT -cert $CERT -key $KEY -p 9200 -icl

_meta:
  type: "internalusers"
  config_version: 2

admin:
  hash: "$2y$12$5iTtBl.18q4yMexkVw7mN.WfQPFbnU4CZDDWXPQau1pQZrbm..UUS"
  reserved: true
  backend_roles:
  - "admin"
  description: "Wazuh admin user"

kibanaserver:
  hash: "$2y$12$NAoPOR4K0zahth1wn8lQP.prJzhR1Uf.xTcI.LiX2znqNRajb4QFm"
  reserved: true
  description: "Wazuh kibanaserver user"

# kibanaro:
#   hash: "$2a$12$JJSXNfTowz7Uu5ttXfeYpeYE0arACvcwlPBStB1F.MI7f0U9Z4DGC"
#   reserved: false
#   backend_roles:
#   - "kibanauser"
#   - "readall"
#   attributes:
#     attribute1: "value1"
#     attribute2: "value2"
#     attribute3: "value3"
#   description: "Wazuh kibanaro user"

# logstash:
#   hash: "$2a$12$u1ShR4l4uBS3Uv59Pa2y5.1uQuZBrZtmNfqB3iM/.jL0XoV9sghS2"
#   reserved: false
#   backend_roles:
#   - "logstash"
#   description: "Wazuh logstash user"

# readall:
#   hash: "$2a$12$ae4ycwzwvLtZxwZ82RmiEunBbIPiAmGZduBAjKN0TXdwQFtCwARz2"
#   reserved: false
#   backend_roles:
#   - "readall"
#   description: "Wazuh readall user"

# snapshotrestore:
#   hash: "$2y$12$DpwmetHKwgYnorbgdvORCenv4NAK8cPUg8AI6pxLCuWf/ALc0.v7W"
#   reserved: false
#   backend_roles:
#   - "snapshotrestore"
#   description: "Wazuh snapshotrestore user"
